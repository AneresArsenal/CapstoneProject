{% extends "base.html" %} {% block content %}
<div class="jumbotron rounded-0">
    <div class="container text-center">
        <div id="jumbo-text">
            <h1 class="display-4">Menufy</h1>
            <p class="lead">Welcome to {{restaurant_id}}</p>
        </div>
    </div>
</div>

<div>
    <table class="table table-hover table-striped table-dark m-5" id="menu">
    </table>

    <script type="text/javascript">
        var menu_data = JSON.parse('{{ menu_data |  safe }}');

        var transform = {
            "tag": "table",
            "children": [{
                "tag": "tbody",
                "children": [{
                    "tag": "tr",
                    'id': '${menu_item_id}',
                    "children": [{
                        "tag": "td",
                        "html": "${item_name}"
                    }, {
                        "tag": "td",
                        "html": "${item_description}"
                    }, {
                        "tag": "td",
                        "html": "${item_unit_price}"
                    }, {
                        "tag": "td",
                        "children": [{
                            '<>': 'button',
                            'id': 'sub',
                            'class': 'sub',
                            'html': '-'
                        }]
                    }, {
                        "tag": "td",
                        "children": [{
                            '<>': 'input',
                            'id': '${menu_item_id}',
                            'class': 'input-group input-group-sm readonly',
                            'value': '0'
                        }]
                    }, {
                        "tag": "td",
                        "children": [{
                            '<>': 'button',
                            'id': 'add',
                            'class': 'add',
                            'html': '+'
                        }]
                    }]
                }]
            }]
        };

        $('#menu').html(json2html.transform(menu_data, transform));


        // var text = "<tr>";
        // var headers = ['Menu Item', 'Description', 'Unit Price', ]

        // for (i = 0; i < headers.length; i++) {
        //     text += '<th scope="col">' + headers[i] + '</th>';
        // }

        // // add column for add column
        // text += '<td scope="col"></td>';

        // text += "</tr>";

        // for (i = 0; i < menu_data.length; i++) {
        //     text += "<tr>";
        //     for (key in menu_data[i]) {
        //         if (key == "item_name" || key == 'item_description' || key == 'item_unit_price')
        //             text += '<td scope="row">' + menu_data[i][key] + "</td>";
        //     }
        //     // text += '<td class="menu"> <form action="" method="post"><button name="menu_item_id" value=' + menu_data[i]["menu_item_id"] + '> Add </button></form></td>';
        //     text += '<td><button type="button" id="sub" class="sub">-</button> <input type="text" class="input-group input-group-sm mb-3" id=' + menu_data[i]["menu_item_id"] + 'value="0" class="field" readonly /><button type="button" id="add" class="add">+</button></td>';
        //     text += "</tr>";
        // }
        // document.getElementById("menu").innerHTML = text;

        $('.add').click(function() {
            $(this).prev().val(+$(this).prev().val() + 1);
        });
        $('.sub').click(function() {
            if ($(this).next().val() > 0) $(this).next().val(+$(this).next().val() - 1);
        });
    </script>
</div>
{% endblock %}